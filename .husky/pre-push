#!/bin/bash

# Pre-push hook to automatically bump version
# This script runs before git push

echo "üöÄ Pre-push: Checking version..."

# Check if we're pushing to main branch
current_branch=$(git symbolic-ref --short HEAD)

if [ "$current_branch" = "main" ] || [ "$current_branch" = "master" ]; then
  echo "üì¶ Pushing to main branch - checking for version bump..."
  
  # Check if version was already bumped in this commit
  version_changed=$(git diff HEAD~1 HEAD -- package.json | grep '"version"')
  
  if [ -z "$version_changed" ]; then
    echo "‚ö†Ô∏è  Version not bumped. Please run: pnpm version:bump [major|minor|patch]"
    echo "Or to skip version bump: git push --no-verify"
    exit 1
  else
    echo "‚úÖ Version was bumped in last commit"
  fi
fi

exit 0
